# Анализ продаж по регионам

Веб-приложение для анализа продаж по региональным складам на основе географии продаж.

## Возможности

- **Загрузка Excel файлов**: Поддержка .xlsx и .xls форматов
- **Автоматическое определение регионов**: Программа знает соответствие городов и регионов России
- **Интерактивная круговая диаграмма**: Визуализация распределения продаж по регионам
- **Таблица статистики**: Сортировка регионов по объему продаж
- **Фильтрация данных**:
  - Фильтр по товарам с отображением регионов продаж
  - Фильтр по регионам с отображением товаров
- **Детальная аналитика**: Подробная информация по выбранным товарам или регионам

## Требования к файлу Excel

Файл должен содержать следующие колонки (названия могут варьироваться):

- **Город** (обязательно): "город", "city"
- **Товар** (обязательно): "товар", "product", "наименование"
- **Количество** (опционально): "количество", "quantity", "кол-во"
- **Сумма** (опционально): "сумма", "amount", "стоимость"

## Как использовать

1. Откройте файл `index.html` в браузере
2. Нажмите кнопку "Выберите файл" и загрузите Excel файл с данными о продажах
3. После загрузки автоматически появятся:
   - Круговая диаграмма распределения продаж по регионам
   - Таблица с регионами, отсортированными по объему продаж
   - Фильтры для детального анализа

## Поддерживаемые регионы

Программа автоматически определяет следующие федеральные округа:

- **Центральный**: Москва, Воронеж, Рязань, Липецк, Тула, Брянск, Курск, Иваново, Тверь, Белгород, Владимир, Орёл, Смоленск
- **Северо-Западный**: Санкт-Петербург, Калининград, Архангельск, Череповец, Мурманск
- **Южный**: Ростов-на-Дону, Волгоград, Краснодар, Астрахань, Сочи, Волжский
- **Северо-Кавказский**: Махачкала, Ставрополь
- **Приволжский**: Казань, Нижний Новгород, Самара, Уфа, Пермь, Саратов, Тольятти, Ижевск, Ульяновск, Оренбург, Пенза, Киров, Чебоксары
- **Уральский**: Екатеринбург, Челябинск, Тюмень, Магнитогорск, Нижний Тагил, Курган
- **Сибирский**: Новосибирск, Омск, Красноярск, Барнаул, Иркутск, Томск, Кемерово, Новокузнецк
- **Дальневосточный**: Хабаровск, Владивосток, Якутск, Чита

## Технологии

- HTML5, CSS3, JavaScript (ES6+)
- [Bootstrap 5](https://getbootstrap.com/) - для стилизации интерфейса
- [Chart.js](https://www.chartjs.org/) - для создания интерактивных диаграмм
- [SheetJS](https://sheetjs.com/) - для чтения Excel файлов

## Файлы проекта

- `index.html` - основной HTML файл с интерфейсом (требует интернет)
- `app.js` - JavaScript код с логикой приложения
- `index_offline.html` - автономная версия без внешних библиотек
- `app_offline.js` - JavaScript для автономной версии
- `продажи.xlsx` - пример файла с данными
- `test_data.csv` - тестовый CSV файл
- `README.md` - документация

## Устранение проблем

### Ошибка "Chart is not defined"

Если появляется ошибка с библиотекой Chart.js:

1. **Используйте автономную версию**: откройте `index_offline.html` вместо `index.html`
2. **Проверьте интернет-соединение**: основная версия требует доступ к CDN
3. **Конвертируйте Excel в CSV**: автономная версия лучше работает с CSV файлами

### Проблемы с Excel файлами

1. **Сохраните файл как CSV**: Файл → Сохранить как → CSV (разделители - запятые)
2. **Проверьте кодировку**: используйте UTF-8
3. **Убедитесь в наличии заголовков**: первая строка должна содержать названия колонок

### Рекомендуемый порядок действий

1. Попробуйте основную версию `index.html`
2. Если есть проблемы с интернетом - используйте `index_offline.html`
3. Если проблемы с Excel - конвертируйте в CSV и используйте `test_data.csv` как пример

## Примеры использования

### Анализ по товарам
1. Выберите товар в фильтре "Фильтр по товару"
2. В секции "Детальная информация" появится таблица с регионами, где продавался выбранный товар

### Анализ по регионам
1. Выберите регион в фильтре "Фильтр по региону"
2. В секции "Детальная информация" появится таблица с товарами, продаваемыми в выбранном регионе

### Общая статистика
- Круговая диаграмма показывает процентное распределение заказов по регионам
- Таблица справа отображает регионы, отсортированные по количеству заказов
- Данные автоматически обновляются при применении фильтров